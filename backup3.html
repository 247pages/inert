/* General Styling */
body {
    font-family: Arial, sans-serif;
    background-color: #121212; /* Dark background */
    color: #e0e0e0; /* Light text color for readability */
    margin: 0;
    padding: 0;
}

/* Navbar Styling */
/* Navbar Styles */
.navbar {
    background-color: #212529; /* Darker background for the navbar */
    border-bottom: 1px solid #444; /* Subtle border for depth */
    padding: 10px 20px; /* Adjusted padding for navbar */
}

/* Plus Icon Button */
#add-post-btn {
    background-color: #007bff; /* Bootstrap primary color */
    border: none; /* Remove default border */
    width: 50px; /* Fixed width for consistency */
    height: 50px; /* Fixed height for consistency */
    border-radius: 50%; /* Circular shape */
    display: flex; /* Center the icon */
    align-items: center; /* Center vertically */
    justify-content: center; /* Center horizontally */
    transition: background-color 0.3s ease, transform 0.3s ease; /* Smooth transitions */
    margin-right: 20px; /* Added margin-right for spacing from the menu icon */
}

#add-post-btn:hover {
    background-color: #0056b3; /* Darken on hover */
    transform: scale(1.1); /* Slightly enlarge on hover */
}

/* Dropdown Menu Styles */
.dropdown-menu {
    background-color: #343a40; /* Dark background for dropdown */
    border: none; /* Remove default border */
    border-radius: 0.5rem; /* Rounded corners */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* Subtle shadow */
}

/* Dropdown Items */
.dropdown-item {
    color: #e0e0e0; /* Light text color for readability */
    padding: 10px 15px; /* Padding for items */
    transition: background-color 0.3s ease; /* Smooth background transition */
}

.dropdown-item:hover {
    background-color: #007bff; /* Highlight background on hover */
    color: #ffffff; /* Change text color on hover */
}

/* Menu Icon (Three Bars) */
.dropdown-toggle {
    background: none; /* Remove background */
    border: none; /* Remove border */
    padding: 10px; /* Padding for spacing */
    color: #ffffff; /* White color for the icon */
    font-size: 24px; /* Size for the icon */
    transition: color 0.3s ease; /* Smooth color transition */
}

.dropdown-toggle:hover {
    color: #007bff; /* Change color on hover */
}

/* Custom Style for Menu Icon Container */
.dropdown {
    position: relative; /* Position relative for dropdown */
}

.dropdown-menu-end {
    right: 0; /* Align dropdown to the right */
    left: auto; /* Reset left alignment */
}

/* General Styling for Buttons */
.btn {
    transition: background-color 0.3s ease, transform 0.3s ease; /* Smooth transition for all buttons */
}

.btn:hover {
    transform: translateY(-2px); /* Slight lift effect on hover */
}

/* Popup Alert */
.popup-alert {
    display: none; /* Hidden by default */
    position: fixed;
    z-index: 1000; /* Sit on top */
    left: 0;
    top: 0;
    width: 100%; /* Full width */
    height: 100%; /* Full height */
    background-color: rgba(0, 0, 0, 0.5); /* Black w/ opacity */
}

.popup-content {
    background-color: #fff;
    margin: 15% auto; /* 15% from the top and centered */
    padding: 20px;
    border: 1px solid #888;
    width: 80%; /* Could be more or less, depending on screen size */
    max-width: 500px; /* Set a max width */
    border-radius: 8px; /* Rounded corners */
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
}

.popup-content h4 {
    margin: 0 0 10px;
}

.popup-content p {
    margin: 10px 0 20px;
}

.close-btn {
    color: #aaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
    cursor: pointer;
}

.close-btn:hover,
.close-btn:focus {
    color: black;
    text-decoration: none;
    cursor: pointer;
}

/* Basic styles for the post container */
/* Basic styles for the post container */
.post {
  opacity: 0; /* Hidden by default for scroll reveal */
  transform: translateY(20px); /* Start position for the animation */
  transition: all 0.5s ease-out; /* Smooth transition for the reveal */
}

.post.show {
  opacity: 1; /* Fully visible when revealed */
  transform: translateY(0); /* Reset position */
}

/* Carousel indicator (dot) styles */
/* Carousel indicator (dot) styles */
.carousel-indicators {
  position: absolute;
  bottom: 15px; /* Adjusted for better spacing */
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  justify-content: center;
  z-index: 15; /* Ensure indicators are above other elements */
}

.carousel-indicators button {
  width: 12px; /* Dot size */
  height: 12px;
  background-color: rgba(255, 255, 255, 0.5); /* Default color for inactive dots with transparency */
  border-radius: 50%; /* Circle shape */
  margin: 0 6px; /* Adjusted spacing */
  border: none; /* Remove default border */
  cursor: pointer; /* Pointer cursor on hover */
  transition: background-color 0.3s ease, transform 0.3s ease; /* Smooth transitions */
}

.carousel-indicators .active {
  background-color: #007bff; /* Color for the active dot */
  transform: scale(1.5); /* Slightly enlarge the active dot */
  box-shadow: 0 0 5px rgba(0, 123, 255, 0.7); /* Glow effect for the active dot */
}

.carousel-indicators button:hover {
  background-color: rgba(255, 255, 255, 0.8); /* Slightly brighter on hover */
  transform: scale(1.1); /* Slightly enlarge on hover */
}

/* Card styles */
.card {
  border: none; /* Remove default border */
  background-color: #1e1e1e; /* Dark card background */
  border-radius: 8px; /* Rounded corners for cards */
  overflow: hidden; /* Ensures rounded corners on images */
}

/* Image styles */
.card img {
  border-radius: 8px; /* Rounded corners for images */
}

/* Dropdown menu styles */
.dropdown-menu {
  min-width: 150px; /* Optional: Minimum width for dropdown */
  background-color: #333; /* Dark dropdown background */
  border: none; /* Remove default border */
}

.dropdown-item {
  color: #e0e0e0; /* Light text color for dropdown items */
}

.dropdown-item:hover {
  background-color: #007bff; /* Highlight background on hover */
}


.popup-alert {
  display: none; /* Hidden by default */
  position: fixed;
  z-index: 1000; /* Sit on top */
  left: 0;
  top: 0;
  width: 100%; /* Full width */
  height: 100%; /* Full height */
  background-color: rgba(0, 0, 0, 0.5); /* Black w/ opacity */
}

.popup-content {
  background-color: #fff;
  margin: 15% auto; /* 15% from the top and centered */
  padding: 20px;
  border: 1px solid #888;
  width: 80%; /* Could be more or less, depending on screen size */
  max-width: 500px; /* Set a max width */
  border-radius: 8px; /* Rounded corners */
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
}

.popup-content h4 {
  margin: 0 0 10px;
}

.popup-content p {
  margin: 10px 0 20px;
}

.close-btn {
  color: #aaa;
  float: right;
  font-size: 28px;
  font-weight: bold;
  cursor: pointer;
}

.close-btn:hover,
.close-btn:focus {
  color: black;
  text-decoration: none;
  cursor: pointer;
}

.btn {
  display: inline-block;
  padding: 10px 20px;
  font-size: 16px;
  color: white;
  background-color: #007bff;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  transition: background-color 0.3s ease;
}

.btn:hover {
  background-color: #0056b3;
}



<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Instagram - Photo Sharing</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
  <link rel="stylesheet" href="/css/postpage.css">
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>

  <!-- Navbar -->
  <nav class="navbar navbar-dark bg-dark">
    <img src="path/to/logo.png" alt="Logo" class="navbar-brand mb-0 h1" style="width: 150px;"> <!-- Replace with the actual path to your logo -->
    <div class="d-flex align-items-center">
      <button id="add-post-btn" class="btn" onclick="redirectToPage()">
        <i class="bi bi-plus"></i>
      </button>
      <div class="dropdown ms-3">
        <button class="btn dropdown-toggle" type="button" id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false">
          <i class="bi bi-list"></i>
        </button>
        <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdownMenuButton">
          <li><a class="dropdown-item" href="#">Page 1</a></li>
          <li><a class="dropdown-item" href="#">Page 2</a></li>
          <li><a class="dropdown-item" href="#" id="logout-btn">Logout</a></li> <!-- This will be moved to the dropdown menu -->
        </ul>
      </div>
    </div>
  </nav>

  <script>
    // Function to redirect to xyz.html
    function redirectToPage() {
        window.location.href = 'xyz.html'; // Redirects to xyz.html
    }
  </script>

  <!-- Auth Section -->
  <div id="auth-section" class="container mt-5">
    <h2>Welcome!</h2>
    <button id="login-btn" class="btn btn-primary">
      <i class="bi bi-google"></i> Login with Google
    </button>
  </div>

  <!-- Popup Alert -->
  <div id="popup-alert" class="popup-alert">
    <div class="popup-content">
      <span id="popup-close" class="close-btn">&times;</span>
      <h4 id="popup-title">Alert Title</h4>
      <p id="popup-message">This is an alert message.</p>
      <button id="popup-confirm" class="btn btn-primary">OK</button>
    </div>
  </div>

  <!-- Posts Section -->
  <div id="posts-section" class="container mt-5" style="display: none;">
    <h3 style="background: linear-gradient(to right, #FF0080, #FF8C00); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">Explore Recent Posts</h3>
    <div id="posts-container"></div>
  </div>

  <!-- Add Post Modal -->
  <div class="modal fade" id="addPostModal" tabindex="-1" aria-labelledby="addPostModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="addPostModalLabel">Add a New Post</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="addPostForm">
            <!-- Add your form fields here -->
            <div class="mb-3">
              <label for="postContent" class="form-label">Post Content</label>
              <textarea class="form-control" id="postContent" rows="3"></textarea>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button type="button" class="btn btn-primary" id="submitPostBtn">Submit Post</button>
        </div>
      </div>
    </div>
  </div>

  <script type="module" src="/js/postpage.js"></script>
</body>
</html>
import { auth, db } from './firebase-config.js';
import { signInWithPopup, GoogleAuthProvider, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/9.10.0/firebase-auth.js";
import { collection, onSnapshot, doc, deleteDoc, updateDoc } from "https://www.gstatic.com/firebasejs/9.10.0/firebase-firestore.js";

// DOM Elements
const authSection = document.getElementById('auth-section');
const postsSection = document.getElementById('posts-section');
const postsContainer = document.getElementById('posts-container');

// Popup Alert Elements
const popupAlert = document.getElementById('popup-alert');
const popupTitle = document.getElementById('popup-title');
const popupMessage = document.getElementById('popup-message');
const popupClose = document.getElementById('popup-close');
const popupConfirm = document.getElementById('popup-confirm');

// Auth State
onAuthStateChanged(auth, (user) => {
  if (user) {
    loadPosts();
    showPostsSection();
  } else {
    showAuthSection();
  }
});

// Show auth section
function showAuthSection() {
  authSection.style.display = 'block';
  postsSection.style.display = 'none';
}

// Show posts section
function showPostsSection() {
  authSection.style.display = 'none';
  postsSection.style.display = 'block';
}

// Google Login
document.getElementById('login-btn').addEventListener('click', async () => {
  const provider = new GoogleAuthProvider();
  await signInWithPopup(auth, provider);
});

// Logout
document.getElementById('logout-btn').addEventListener('click', async () => {
  await signOut(auth);
  window.location.reload();
});

// Load Posts
function loadPosts() {
  onSnapshot(collection(db, "posts"), (snapshot) => {
    postsContainer.innerHTML = '';  // Clear posts
    snapshot.forEach((doc) => {
      const post = doc.data();
      const postElement = createPostElement({
        ...post,
        imageUrls: post.imageUrls || [] // Ensure imageUrls is an array
      }, doc.id);
      postsContainer.appendChild(postElement);

      const deleteButton = postElement.querySelector('.delete-post-btn');
      if (deleteButton) {
        deleteButton.addEventListener('click', () => handleDeletePost(doc.id));
      }

      const reportButton = postElement.querySelector('.report-post-btn');
      if (reportButton) {
        reportButton.addEventListener('click', () => handleReportPost(doc.id));
      }

      // Add event listener for dot navigation
      const dots = postElement.querySelectorAll('.dot');
      dots.forEach((dot, index) => {
        dot.addEventListener('click', () => changeSlide(doc.id, index));
      });
    });

    // Apply scroll reveal animation to posts
    scrollReveal();
  });
}

// Handle Post Deletion
async function handleDeletePost(postId) {
  showPopup("Confirm Deletion", "Are you sure you want to delete this post?", async () => {
    await deleteDoc(doc(db, "posts", postId));
    showPopup("Success", "Post deleted successfully.");
  });
}

// Handle Post Reporting
async function handleReportPost(postId) {
  showPopup("Confirm Reporting", "Are you sure you want to report this post?", async () => {
    const postRef = doc(db, "posts", postId);
    await updateDoc(postRef, { reported: true });
    showPopup("Success", "Post reported successfully.");
  });
}

// Show Popup Alert
function showPopup(title, message, onConfirm) {
  popupTitle.textContent = title;
  popupMessage.textContent = message;
  popupAlert.style.display = 'block';

  // Confirm action
  popupConfirm.onclick = () => {
    onConfirm();
    popupAlert.style.display = 'none'; // Close popup
  };

  // Close popup
  popupClose.onclick = () => {
    popupAlert.style.display = 'none';
  };
}

// Smooth Scroll Animation (Posts entering the viewport)
function scrollReveal() {
  const posts = document.querySelectorAll('.post');

  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.classList.add('show');
      } else {
        entry.target.classList.remove('show');
      }
    });
  });

  posts.forEach(post => {
    observer.observe(post);
  });
}

// Create Post Element with carousel and indicators (dots)
function createPostElement(post, postId) {
  const user = auth.currentUser; // Get the current logged-in user

  const postDiv = document.createElement('div');
  postDiv.classList.add('post', 'card', 'mb-3');

  // Check if there are multiple images
  const imagesContent = post.imageUrls.length > 0 ? `
<!-- Simplified Carousel for multiple images with only indicators -->
<div id="carousel${postId}" class="carousel slide" data-bs-ride="carousel">
  <div class="carousel-inner">
    ${post.imageUrls.map((url, index) => `
      <div class="carousel-item ${index === 0 ? 'active' : ''}">
        <img src="${url}" class="d-block w-100" alt="Post Image ${index + 1}">
      </div>
    `).join('')}
  </div>
  
  <!-- Indicators (Dots for toggling) -->
  <div class="carousel-indicators">
    ${post.imageUrls.map((url, index) => `
      <button type="button" data-bs-target="#carousel${postId}" data-bs-slide-to="${index}" class="${index === 0 ? 'active dot' : 'dot'}" aria-current="${index === 0 ? 'true' : 'false'}" aria-label="Slide ${index + 1}"></button>
    `).join('')}
  </div>
</div>
  ` : '<p>No images for this post.</p>';

  postDiv.innerHTML = `
    <div class="card-body">
      <div class="d-flex justify-content-between">
        <div>
          <h5 class="card-title">${post.title}</h5>
          <p class="card-text">${post.description}</p>
        </div>
        <!-- Three Dots Dropdown -->
        <div class="dropdown">
          <button class="btn btn-link text-dark three-dots-btn" type="button" id="dropdownMenuButton${postId}" data-bs-toggle="dropdown" aria-expanded="false">
            <i class="bi bi-three-dots"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdownMenuButton${postId}">
            <li><button class="dropdown-item report-post-btn">Report this post</button></li>
            ${post.userId === user.uid ? `<li><button class="dropdown-item delete-post-btn">Delete this post</button></li>` : ''}
          </ul>
        </div>
      </div>
      ${imagesContent}
    </div>
  `;

  return postDiv;
}

// Change slide based on dot click
function changeSlide(postId, index) {
  const carousel = document.querySelector(`#carousel${postId}`);
  const items = carousel.querySelectorAll('.carousel-item');
  const dots = carousel.querySelectorAll('.dot');

  // Remove active class from all items and dots
  items.forEach(item => item.classList.remove('active'));
  dots.forEach(dot => dot.classList.remove('active'));

  // Add active class to the selected item and dot
  items[index].classList.add('active');
  dots[index].classList.add('active');
}
